import{q as X,r,c as k,x as q,y as G,z as J,N as Q,A as Y,w as N,d as e,b as c,e as F,O as Z,v as A,p as ee,j as m,a as g,f as C,o as b,F as K,g as O,t as a,C as P,i as te}from"./app-CjypaZZX.js";import{_ as se}from"./AuthenticatedLayout-C77VJERb.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo-DeNzv_1-.js";const oe={class:"space-y-5 px-4 py-3"},ae={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},ne={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},ie={class:"relative w-full sm:w-80"},de={class:"flex gap-3"},re=["disabled"],ue=["disabled"],ce={class:"flex flex-col gap-2 sm:flex-row"},me={class:"flex items-center gap-3"},xe=["disabled"],pe={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm"},ve={class:"overflow-x-auto"},fe={class:"min-w-full text-sm"},be={class:"bg-gray-50 text-gray-700"},ge={class:"px-2 py-3 font-semibold sm:px-4"},ye={class:"px-2 py-3 font-semibold sm:px-4 hidden sm:table-cell"},he={class:"px-2 py-3 font-semibold sm:px-4"},we={class:"px-2 py-3 font-semibold sm:px-4"},_e={class:"px-2 py-3 font-semibold sm:px-4 hidden md:table-cell"},ke={class:"px-2 py-3 font-semibold sm:px-4 hidden md:table-cell"},Ce={class:"px-2 py-3 font-semibold sm:px-4 hidden md:table-cell"},Se={class:"px-2 py-3 font-medium text-gray-800 sm:px-4"},Me={class:"px-2 py-3 text-gray-700 sm:px-4 hidden sm:table-cell"},je=["href"],$e={class:"px-2 py-3 sm:px-4"},Re={class:"px-2 py-3 sm:px-4"},Te={class:"px-2 py-3 sm:px-4 hidden md:table-cell"},ze={class:"px-2 py-3 sm:px-4 hidden md:table-cell"},Be={class:"px-2 py-3 sm:px-4 hidden md:table-cell"},Ne={class:"px-2 py-3 sm:px-4"},Fe=["onClick"],Ve={key:1},De={class:"flex flex-col items-center justify-between gap-3 border-t bg-gray-50 px-2 py-3 text-sm sm:flex-row sm:px-4"},Ie={class:"text-gray-600"},Le={class:"font-semibold"},qe={class:"font-semibold"},Ae={class:"flex items-center gap-2"},Ke=["disabled"],Oe=["disabled"],Pe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4","aria-modal":"true",role:"dialog"},Ee={class:"w-full max-w-lg rounded-2xl bg-white p-5 shadow-xl mx-4"},He={class:"mt-4"},Ue={class:"mt-2 flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between text-xs text-gray-500"},We={class:"mt-5 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end"},Xe=["disabled"],Ge={components:{SortIcon:{props:{active:Boolean,dir:String},template:`
        <span class="inline-flex h-4 w-4 items-center justify-center">
          <svg v-if="active && dir==='asc'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="h-4 w-4 fill-current opacity-70"><path d="M10 5l5 6H5l5-6z"/></svg>
          <svg v-else-if="active && dir==='desc'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="h-4 w-4 fill-current opacity-70"><path d="M10 15l-5-6h10l-5 6z"/></svg>
          <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="h-4 w-4 fill-current opacity-30"><path d="M7 7h6l-3-3-3 3zm0 6l3 3 3-3H7z"/></svg>
        </span>
      `}}},Je=Object.assign(Ge,{__name:"Index",setup(Qe){const S=X.create({headers:{"X-Requested-With":"XMLHttpRequest"}}),V=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");V&&(S.defaults.headers.common["X-CSRF-TOKEN"]=V);const x=r(!1),h=r(!1),M=r([]),w=r(""),j=r(""),d=r("doctor"),n=r("asc"),u=r(1),y=r(10),$=k(()=>Math.max(1,Math.ceil(H.value.length/y.value))),E=k(()=>{const l=(u.value-1)*y.value;return D.value.slice(l,l+y.value)}),R=r(!1),o=q({schedule_id:null,doctor_id:null,text:""}),p=q({show:!1,type:"success",message:""});function _(l,t="success",i=2e3){p.message=l,p.type=t,p.show=!0,setTimeout(()=>p.show=!1,i)}async function v(){x.value=!0;try{const{data:l}=await S.get("/admin/schedules/list",{params:{search:j.value||""}});M.value=Array.isArray(l)?l:[],u.value=1}catch(l){_(l?.response?.data?.message||"Failed to load schedules","error",3500)}finally{x.value=!1}}let T=null;G(w,l=>{T&&clearTimeout(T),T=setTimeout(()=>{j.value=l,v()},300)});function f(l){d.value===l?n.value=n.value==="asc"?"desc":"asc":(d.value=l,n.value="asc")}const D=k(()=>{const l=n.value==="asc"?1:-1,t=d.value;return[...M.value].sort((i,s)=>{const B=(i?.[t]??"").toString().toLowerCase(),L=(s?.[t]??"").toString().toLowerCase();return B<L?-1*l:B>L?1*l:0})}),H=k(()=>D.value);function U(l){R.value=!0,o.schedule_id=l.id,o.doctor_id=l.doctor_id,o.text=""}function z(){R.value=!1,o.schedule_id=null,o.doctor_id=null,o.text=""}async function W(){if(!o.text.trim()){_("Write a message first","error");return}h.value=!0;try{await S.post("/admin/schedules/mention",{schedule_id:o.schedule_id,doctor_id:o.doctor_id,message:o.text.trim()}),_("Message sent"),z()}catch(l){_(l?.response?.data?.message||"Failed to send message","error",3500)}finally{h.value=!1}}function I(){w.value="",j.value="",v()}return J(v),(l,t)=>{const i=Q("SortIcon");return b(),Y(se,{title:"Doctors Schedules"},{default:N(()=>[e("div",oe,[e("div",ae,[e("div",ne,[e("div",ie,[F(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>w.value=s),onKeyup:Z(v,["enter"]),placeholder:"Search by doctor or email",class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm outline-none transition focus:border-blue-500 focus:ring-2 focus:ring-blue-200","aria-label":"Search schedules"},null,544),[[A,w.value,void 0,{trim:!0}]]),t[12]||(t[12]=e("span",{class:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"},"⌘K",-1))]),e("div",de,[e("button",{class:"rounded-xl border bg-white px-4 py-2 text-sm font-medium shadow-sm transition hover:bg-gray-50 active:scale-[.98]",onClick:v,disabled:x.value}," Search ",8,re),e("button",{class:"rounded-xl border px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-50",onClick:I,disabled:x.value}," Reset ",8,ue)])]),e("div",ce,[e("div",me,[t[14]||(t[14]=e("label",{class:"text-sm text-gray-500 sm:hidden"},"Rows per page",-1)),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),class:"rounded-xl border border-gray-300 bg-white px-6 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200"},[...t[13]||(t[13]=[e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1)])],512),[[ee,y.value,void 0,{number:!0}]])]),e("button",{class:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-700 active:scale-[.98] w-full sm:w-auto",onClick:v,disabled:x.value}," Refresh ",8,xe)])]),e("div",pe,[e("div",ve,[e("table",fe,[e("thead",be,[e("tr",null,[e("th",ge,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[2]||(t[2]=s=>f("doctor"))},[t[15]||(t[15]=m(" Doctor ",-1)),c(i,{active:d.value==="doctor",dir:n.value},null,8,["active","dir"])])]),e("th",ye,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[3]||(t[3]=s=>f("email"))},[t[16]||(t[16]=m(" Email ",-1)),c(i,{active:d.value==="email",dir:n.value},null,8,["active","dir"])])]),e("th",he,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[4]||(t[4]=s=>f("day"))},[t[17]||(t[17]=m(" Day ",-1)),c(i,{active:d.value==="day",dir:n.value},null,8,["active","dir"])])]),e("th",we,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[5]||(t[5]=s=>f("time"))},[t[18]||(t[18]=m(" Time ",-1)),c(i,{active:d.value==="time",dir:n.value},null,8,["active","dir"])])]),e("th",_e,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[6]||(t[6]=s=>f("slot"))},[t[19]||(t[19]=m(" Slot ",-1)),c(i,{active:d.value==="slot",dir:n.value},null,8,["active","dir"])])]),e("th",ke,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[7]||(t[7]=s=>f("max"))},[t[20]||(t[20]=m(" Max/day ",-1)),c(i,{active:d.value==="max",dir:n.value},null,8,["active","dir"])])]),e("th",Ce,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[8]||(t[8]=s=>f("fee"))},[t[21]||(t[21]=m(" Fees ",-1)),c(i,{active:d.value==="fee",dir:n.value},null,8,["active","dir"])])]),t[22]||(t[22]=e("th",{class:"px-2 py-3 font-semibold sm:px-4"},null,-1))])]),e("tbody",null,[x.value?(b(),g(K,{key:0},O(6,s=>e("tr",{key:"skeleton-"+s,class:"border-t"},[...t[23]||(t[23]=[e("td",{class:"px-2 py-3 sm:px-4",colspan:"8"},[e("div",{class:"h-5 w-full animate-pulse rounded bg-gray-100"})],-1)])])),64)):C("",!0),(b(!0),g(K,null,O(E.value,s=>(b(),g("tr",{key:s.id,class:"border-t hover:bg-gray-50"},[e("td",Se,a(s.doctor),1),e("td",Me,[e("a",{href:"mailto:"+s.email,class:"text-blue-600 hover:underline"},a(s.email),9,je)]),e("td",$e,a(s.day),1),e("td",Re,a(s.time),1),e("td",Te,a(s.slot),1),e("td",ze,a(s.max),1),e("td",Be,a(s.fee),1),e("td",Ne,[e("button",{class:"rounded-lg border px-3 py-1.5 text-sm font-medium transition hover:bg-gray-100",onClick:B=>U(s)}," Mention ",8,Fe)])]))),128)),!x.value&&M.value.length===0?(b(),g("tr",Ve,[e("td",{colspan:"8",class:"px-2 py-12 sm:px-4"},[e("div",{class:"mx-auto max-w-md text-center"},[t[24]||(t[24]=e("div",{class:"mx-auto mb-4 h-12 w-12 rounded-full bg-gray-100"},null,-1)),t[25]||(t[25]=e("h3",{class:"text-base font-semibold text-gray-900"}," No schedules found ",-1)),t[26]||(t[26]=e("p",{class:"mt-1 text-sm text-gray-500"}," Try adjusting your search or refresh the list. ",-1)),e("div",{class:"mt-4 flex items-center justify-center gap-2"},[e("button",{class:"rounded-xl border px-4 py-2 text-sm font-medium transition hover:bg-gray-50",onClick:I}," Clear filters "),e("button",{class:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700",onClick:v}," Refresh ")])])])])):C("",!0)])])]),e("div",De,[e("div",Ie,[t[27]||(t[27]=m(" Page ",-1)),e("span",Le,a(u.value),1),t[28]||(t[28]=m(" of ",-1)),e("span",qe,a($.value),1)]),e("div",Ae,[e("button",{class:"rounded-lg border px-3 py-1.5 disabled:cursor-not-allowed disabled:opacity-40",disabled:u.value===1,onClick:t[9]||(t[9]=s=>u.value=Math.max(1,u.value-1))}," Prev ",8,Ke),e("button",{class:"rounded-lg border px-3 py-1.5 disabled:cursor-not-allowed disabled:opacity-40",disabled:u.value===$.value,onClick:t[10]||(t[10]=s=>u.value=Math.min($.value,u.value+1))}," Next ",8,Oe)])])]),c(P,{name:"fade"},{default:N(()=>[R.value?(b(),g("div",Pe,[e("div",Ee,[e("div",{class:"flex items-start justify-between"},[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold"}," Private message to doctor ",-1)),e("button",{class:"rounded-lg p-1 hover:bg-gray-100",onClick:z,"aria-label":"Close"}," ✕ ")]),e("div",He,[F(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=s=>o.text=s),rows:"5",class:"w-full rounded-xl border border-gray-300 px-3 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",placeholder:"Write a private message…"},null,512),[[A,o.text]]),e("div",Ue,[e("span",null,a(o.text.length)+" characters",1),e("span",null,"Schedule #"+a(o.schedule_id),1)])]),e("div",We,[e("button",{class:"rounded-xl border px-4 py-2 text-sm hover:bg-gray-50 w-full sm:w-auto",onClick:z}," Cancel "),e("button",{class:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-700 disabled:opacity-50 w-full sm:w-auto",disabled:h.value||!o.text.trim(),onClick:W},a(h.value?"Sending…":"Send"),9,Xe)])])])):C("",!0)]),_:1}),c(P,{name:"slide-up"},{default:N(()=>[p.show?(b(),g("div",{key:0,class:te(["fixed bottom-6 left-1/2 z-50 -translate-x-1/2 rounded-xl px-4 py-2 text-sm shadow-lg max-w-xs sm:max-w-sm text-center",p.type==="error"?"bg-red-600 text-white":"bg-gray-900 text-white"]),role:"status"},a(p.message),3)):C("",!0)]),_:1})])]),_:1})}}}),st=le(Je,[["__scopeId","data-v-17814efd"]]);export{st as default};
