import{k as X,q as d,p as k,s as q,x as G,y as J,r as Q,z as Y,w as N,b as e,a as c,j as F,N as Z,A,v as ee,f as v,c as g,d as C,o as f,F as K,e as P,t as a,C as E,n as te}from"./app-oeSv801o.js";import{_ as se}from"./AuthenticatedLayout-DkzJIepr.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo-DeNzv_1-.js";const le={class:"space-y-5 px-4 py-3"},ae={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},ne={class:"flex items-center gap-3"},ie={class:"relative"},re=["disabled"],de=["disabled"],ue={class:"flex items-center gap-3"},ce=["disabled"],ve={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm"},me={class:"overflow-x-auto"},pe={class:"min-w-full text-sm"},xe={class:"bg-gray-50 text-gray-700"},be={class:"px-4 py-3 font-semibold"},fe={class:"px-4 py-3 font-semibold"},ge={class:"px-4 py-3 font-semibold"},ye={class:"px-4 py-3 font-semibold"},he={class:"px-4 py-3 font-semibold"},we={class:"px-4 py-3 font-semibold"},_e={class:"px-4 py-3 font-semibold"},ke={class:"px-4 py-3 font-medium text-gray-800"},Ce={class:"px-4 py-3 text-gray-700"},Se=["href"],Me={class:"px-4 py-3"},je={class:"px-4 py-3"},$e={class:"px-4 py-3"},Re={class:"px-4 py-3"},Te={class:"px-4 py-3"},ze={class:"px-4 py-3 text-right"},Be=["onClick"],Ne={key:1},Fe={class:"flex flex-col items-center justify-between gap-3 border-t bg-gray-50 px-4 py-3 text-sm md:flex-row"},Ve={class:"text-gray-600"},De={class:"font-semibold"},Ie={class:"font-semibold"},Le={class:"flex items-center gap-2"},qe=["disabled"],Ae=["disabled"],Ke={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4","aria-modal":"true",role:"dialog"},Pe={class:"w-full max-w-lg rounded-2xl bg-white p-5 shadow-xl"},Ee={class:"mt-4"},He={class:"mt-2 flex items-center justify-between text-xs text-gray-500"},Oe={class:"mt-5 flex items-center justify-end gap-2"},Ue=["disabled"],We={components:{SortIcon:{props:{active:Boolean,dir:String},template:`
        <span class="inline-flex h-4 w-4 items-center justify-center">
          <svg v-if="active && dir==='asc'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="h-4 w-4 fill-current opacity-70"><path d="M10 5l5 6H5l5-6z"/></svg>
          <svg v-else-if="active && dir==='desc'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="h-4 w-4 fill-current opacity-70"><path d="M10 15l-5-6h10l-5 6z"/></svg>
          <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="h-4 w-4 fill-current opacity-30"><path d="M7 7h6l-3-3-3 3zm0 6l3 3 3-3H7z"/></svg>
        </span>
      `}}},Xe=Object.assign(We,{__name:"Index",setup(Ge){const S=X.create({headers:{"X-Requested-With":"XMLHttpRequest"}}),V=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");V&&(S.defaults.headers.common["X-CSRF-TOKEN"]=V);const m=d(!1),h=d(!1),M=d([]),w=d(""),j=d(""),r=d("doctor"),n=d("asc"),u=d(1),y=d(10),$=k(()=>Math.max(1,Math.ceil(O.value.length/y.value))),H=k(()=>{const o=(u.value-1)*y.value;return D.value.slice(o,o+y.value)}),R=d(!1),l=q({schedule_id:null,doctor_id:null,text:""}),p=q({show:!1,type:"success",message:""});function _(o,t="success",i=2e3){p.message=o,p.type=t,p.show=!0,setTimeout(()=>p.show=!1,i)}async function x(){m.value=!0;try{const{data:o}=await S.get("/admin/schedules/list",{params:{search:j.value||""}});M.value=Array.isArray(o)?o:[],u.value=1}catch(o){_(o?.response?.data?.message||"Failed to load schedules","error",3500)}finally{m.value=!1}}let T=null;G(w,o=>{T&&clearTimeout(T),T=setTimeout(()=>{j.value=o,x()},300)});function b(o){r.value===o?n.value=n.value==="asc"?"desc":"asc":(r.value=o,n.value="asc")}const D=k(()=>{const o=n.value==="asc"?1:-1,t=r.value;return[...M.value].sort((i,s)=>{const B=(i?.[t]??"").toString().toLowerCase(),L=(s?.[t]??"").toString().toLowerCase();return B<L?-1*o:B>L?1*o:0})}),O=k(()=>D.value);function U(o){R.value=!0,l.schedule_id=o.id,l.doctor_id=o.doctor_id,l.text=""}function z(){R.value=!1,l.schedule_id=null,l.doctor_id=null,l.text=""}async function W(){if(!l.text.trim()){_("Write a message first","error");return}h.value=!0;try{await S.post("/admin/schedules/mention",{schedule_id:l.schedule_id,doctor_id:l.doctor_id,message:l.text.trim()}),_("Message sent"),z()}catch(o){_(o?.response?.data?.message||"Failed to send message","error",3500)}finally{h.value=!1}}function I(){w.value="",j.value="",x()}return J(x),(o,t)=>{const i=Q("SortIcon");return f(),Y(se,{title:"Doctors Schedules"},{default:N(()=>[e("div",le,[e("div",ae,[e("div",ne,[e("div",ie,[F(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>w.value=s),onKeyup:Z(x,["enter"]),placeholder:"Search by doctor or email",class:"w-72 md:w-96 rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm outline-none transition focus:border-blue-500 focus:ring-2 focus:ring-blue-200","aria-label":"Search schedules"},null,544),[[A,w.value,void 0,{trim:!0}]]),t[12]||(t[12]=e("span",{class:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"},"⌘K",-1))]),e("button",{class:"rounded-xl border bg-white px-4 py-2 text-sm font-medium shadow-sm transition hover:bg-gray-50 active:scale-[.98]",onClick:x,disabled:m.value}," Search ",8,re),e("button",{class:"rounded-xl border px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-50",onClick:I,disabled:m.value}," Reset ",8,de)]),e("div",ue,[t[14]||(t[14]=e("label",{class:"hidden md:block text-sm text-gray-500"},"Rows per page",-1)),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),class:"rounded-xl border border-gray-300 bg-white px-6 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200"},[...t[13]||(t[13]=[e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1)])],512),[[ee,y.value,void 0,{number:!0}]]),e("button",{class:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-700 active:scale-[.98]",onClick:x,disabled:m.value}," Refresh ",8,ce)])]),e("div",ve,[e("div",me,[e("table",pe,[e("thead",xe,[e("tr",null,[e("th",be,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[2]||(t[2]=s=>b("doctor"))},[t[15]||(t[15]=v(" Doctor ",-1)),c(i,{active:r.value==="doctor",dir:n.value},null,8,["active","dir"])])]),e("th",fe,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[3]||(t[3]=s=>b("email"))},[t[16]||(t[16]=v(" Email ",-1)),c(i,{active:r.value==="email",dir:n.value},null,8,["active","dir"])])]),e("th",ge,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[4]||(t[4]=s=>b("day"))},[t[17]||(t[17]=v(" Day ",-1)),c(i,{active:r.value==="day",dir:n.value},null,8,["active","dir"])])]),e("th",ye,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[5]||(t[5]=s=>b("time"))},[t[18]||(t[18]=v(" Time ",-1)),c(i,{active:r.value==="time",dir:n.value},null,8,["active","dir"])])]),e("th",he,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[6]||(t[6]=s=>b("slot"))},[t[19]||(t[19]=v(" Slot ",-1)),c(i,{active:r.value==="slot",dir:n.value},null,8,["active","dir"])])]),e("th",we,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[7]||(t[7]=s=>b("max"))},[t[20]||(t[20]=v(" Max/day ",-1)),c(i,{active:r.value==="max",dir:n.value},null,8,["active","dir"])])]),e("th",_e,[e("button",{class:"flex items-center gap-1 hover:underline",onClick:t[8]||(t[8]=s=>b("fee"))},[t[21]||(t[21]=v(" Fees ",-1)),c(i,{active:r.value==="fee",dir:n.value},null,8,["active","dir"])])]),t[22]||(t[22]=e("th",{class:"px-4 py-3 font-semibold"},null,-1))])]),e("tbody",null,[m.value?(f(),g(K,{key:0},P(6,s=>e("tr",{key:"skeleton-"+s,class:"border-t"},[...t[23]||(t[23]=[e("td",{class:"px-4 py-3",colspan:"8"},[e("div",{class:"h-5 w-full animate-pulse rounded bg-gray-100"})],-1)])])),64)):C("",!0),(f(!0),g(K,null,P(H.value,s=>(f(),g("tr",{key:s.id,class:"border-t hover:bg-gray-50"},[e("td",ke,a(s.doctor),1),e("td",Ce,[e("a",{href:"mailto:"+s.email,class:"text-blue-600 hover:underline"},a(s.email),9,Se)]),e("td",Me,a(s.day),1),e("td",je,a(s.time),1),e("td",$e,a(s.slot),1),e("td",Re,a(s.max),1),e("td",Te,a(s.fee),1),e("td",ze,[e("button",{class:"rounded-lg border px-3 py-1.5 text-sm font-medium transition hover:bg-gray-100",onClick:B=>U(s)}," Mention ",8,Be)])]))),128)),!m.value&&M.value.length===0?(f(),g("tr",Ne,[e("td",{colspan:"8",class:"px-6 py-16"},[e("div",{class:"mx-auto max-w-md text-center"},[t[24]||(t[24]=e("div",{class:"mx-auto mb-4 h-12 w-12 rounded-full bg-gray-100"},null,-1)),t[25]||(t[25]=e("h3",{class:"text-base font-semibold text-gray-900"}," No schedules found ",-1)),t[26]||(t[26]=e("p",{class:"mt-1 text-sm text-gray-500"}," Try adjusting your search or refresh the list. ",-1)),e("div",{class:"mt-4 flex items-center justify-center gap-2"},[e("button",{class:"rounded-xl border px-4 py-2 text-sm font-medium transition hover:bg-gray-50",onClick:I}," Clear filters "),e("button",{class:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700",onClick:x}," Refresh ")])])])])):C("",!0)])])]),e("div",Fe,[e("div",Ve,[t[27]||(t[27]=v(" Page ",-1)),e("span",De,a(u.value),1),t[28]||(t[28]=v(" of ",-1)),e("span",Ie,a($.value),1)]),e("div",Le,[e("button",{class:"rounded-lg border px-3 py-1.5 disabled:cursor-not-allowed disabled:opacity-40",disabled:u.value===1,onClick:t[9]||(t[9]=s=>u.value=Math.max(1,u.value-1))}," Prev ",8,qe),e("button",{class:"rounded-lg border px-3 py-1.5 disabled:cursor-not-allowed disabled:opacity-40",disabled:u.value===$.value,onClick:t[10]||(t[10]=s=>u.value=Math.min($.value,u.value+1))}," Next ",8,Ae)])])]),c(E,{name:"fade"},{default:N(()=>[R.value?(f(),g("div",Ke,[e("div",Pe,[e("div",{class:"flex items-start justify-between"},[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold"}," Private message to doctor ",-1)),e("button",{class:"rounded-lg p-1 hover:bg-gray-100",onClick:z,"aria-label":"Close"}," ✕ ")]),e("div",Ee,[F(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=s=>l.text=s),rows:"5",class:"w-full rounded-xl border border-gray-300 px-3 py-2 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",placeholder:"Write a private message…"},null,512),[[A,l.text]]),e("div",He,[e("span",null,a(l.text.length)+" characters",1),e("span",null,"Schedule #"+a(l.schedule_id),1)])]),e("div",Oe,[e("button",{class:"rounded-xl border px-4 py-2 text-sm hover:bg-gray-50",onClick:z}," Cancel "),e("button",{class:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-700 disabled:opacity-50",disabled:h.value||!l.text.trim(),onClick:W},a(h.value?"Sending…":"Send"),9,Ue)])])])):C("",!0)]),_:1}),c(E,{name:"slide-up"},{default:N(()=>[p.show?(f(),g("div",{key:0,class:te(["fixed bottom-6 left-1/2 z-50 -translate-x-1/2 rounded-xl px-4 py-2 text-sm shadow-lg",p.type==="error"?"bg-red-600 text-white":"bg-gray-900 text-white"]),role:"status"},a(p.message),3)):C("",!0)]),_:1})])]),_:1})}}}),et=oe(Xe,[["__scopeId","data-v-f410c616"]]);export{et as default};
